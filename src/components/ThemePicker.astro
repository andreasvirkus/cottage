<div>
  <span class="theme-picker-title">← light themes | dark themes →</span>
  <div data-theme-picker class="theme-picker-palette">
    <button style="--theme-bg: var(--theme-light)" data-theme="light"></button>
    <button style="--theme-bg: var(--theme-light-2)" data-theme="light-2"></button>
    <hr class="theme-picker-separator">
    <button style="--theme-bg: var(--theme-dark)" data-theme="dark"></button>
    <button style="--theme-bg: var(--theme-dark-2)" data-theme="dark-2"></button>
    <button style="--theme-bg: var(--theme-dark-3)" data-theme="dark-3"></button>
  </div>
</div>

<script>
  const picker = document.querySelector('[data-theme-picker]')
  const themeBtn = picker?.querySelectorAll('button') || []
  let prevCursorColor: string

  const sound = new URL('../assets/sounds/boop-5.mp3', import.meta.url)
  const audio = new Audio(sound.href)

  themeBtn.forEach((btn) => {
    btn.addEventListener('click', () => {
      const theme = btn.dataset.theme || ''
      document.documentElement.setAttribute('data-theme', theme)
      localStorage.setItem('_cottageTheme', theme)
      ding()
    })

    btn.addEventListener('mouseenter', (event) => {
      if (event.target === null || !(event.target instanceof HTMLElement)) return

      prevCursorColor = getComputedStyle(document.body).getPropertyValue('--cursor-color')
      const btnTheme = getComputedStyle(event.target).getPropertyValue('--theme-bg')
      document.documentElement.style.setProperty('--cursor-color', btnTheme)
    })

    btn.addEventListener('mouseleave', () => {
      document.documentElement.style.setProperty('--cursor-color', prevCursorColor)
    })

    btn.addEventListener('click', (event) => {
      if (event.target === null || !(event.target instanceof HTMLElement)) return
      const btnTheme = (prevCursorColor = getComputedStyle(event.target).getPropertyValue('--theme-bg'))
      document.documentElement.style.setProperty('--cursor-color', btnTheme)
    })
  })

  function ding() {
    audio.play()
  }
</script>

<style>
  .theme-picker-title {
    display: block;
    margin-top: 2rem;
    margin-left: -1.45rem;
    font-size: 1rem;
    letter-spacing: 1px;
  }

  .theme-picker-palette {
    display: flex;
    gap: 0.25rem;
    align-items: center;
    justify-content: center;
  }

  .theme-picker-separator {
    display: inline-block;
    width: 2px;
    margin: 0;
    margin-right: 2px;
    &::after {
      content: '';
      position: absolute;
      background: var(--text-color);
      width: 2px;
      height: 60px;
      translate: 0 -30px;
      padding: 0;
    }
  }

  button {
    border: 4px transparent;
    height: 1.25rem;
    width: 1.25rem;
    background-color: var(--theme-bg);
    transition:
      box-shadow 0.2s ease-out,
      border-radius 0.2s ease-out;

    &:hover,
    &:focus {
      box-shadow: 0 0 0 0.2rem var(--theme-bg);
      outline: 5px solid var(--theme-bg);
      background-color: transparent;
    }
  }
</style>
